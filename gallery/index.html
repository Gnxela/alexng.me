<head>
	<link rel="stylesheet" type="text/css" href="index.css">
	<link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300|Raleway:300" rel="stylesheet">
	<script src="jquery-3.0.0.min.js"></script>
	<title>Alex Ng / Gallery</title>
</head>
<body>
	<div class="nav-bar">
		<div class="title">Gallery</div>
	</div>
	<!-- Hardcoding in to get format, will redo dynamically when I have it looking nice -->
	<div class="overlay">

	</div>
	<div class="gallery-container">
		<div class="album">
			<div class="polaroid">
				<img src="../res/portfolio.png" />
				<h2>Me and the lads in Galway</h2>
			</div>
			<div class="polaroid">
				<img src="../res/portfolio.png" />
				<h2>Me and the lads in Galway</h2>
			</div>
			<div class="polaroid">
				<img src="../res/portfolio.png" />
				<h2>Me and the lads in Galway</h2>
			</div>
		</div>
		<div class="album">
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                        <div class="polaroid">
                                <img src="../res/portfolio.png" />
                                <h2>Me and the lads in Galway</h2>
                        </div>
                </div>
	</div>
</body>
<script>
$(document).ready(function() {
	$(".polaroid").each(function() {
		$(this).css("margin-left", function (index, curValue) {
			return parseInt(curValue, 10) + (Math.floor(Math.random() * 20) - 9) + 'px';
		});
		$(this).css("margin-top", function (index, curValue) {
                        return parseInt(curValue, 10) + (Math.floor(Math.random() * 20) - 9) + 'px';
                });
		var original = $(this).offset();
		$(this).css({"transform" : "rotate(" + (Math.floor((Math.random() * 10) -4)) + "deg)"});
		var rotated = $(this).offset();
		$(this).data({
			dx: rotated.left - original.left,
			dy: rotated.top - original.top
		});
	});
	$(".album").click(function() {
		$(this).addClass("open");
		$(".overlay").css({"display": "block"});
		$(this).children(".polaroid").each(function(index) {//Add all the images first as to get correct positions
			var old = $(this);
			var neww = old.clone().attr("id", index).appendTo('.overlay');
			neww.css("opacity", 0);
		});
		$(this).children(".polaroid").each(function(index) {
			var old = $(this);
			var neww = $(".overlay").find("#" + index);
			var newOffset = neww.offset();
			var oldOffset = old.offset();
			var temp = old.clone().appendTo('body');
			temp.css('position', 'absolute').css('left', oldOffset.left - old.data('dx') - parseInt($(this).css("margin-left"))).css('top', oldOffset.top - old.data('dy') - parseInt($(this).css("margin-top"))).css('z-index', 1000);
			old.css("opacity", 0);
			temp.animate({'top': newOffset.top - old.data('dy') - parseInt($(this).css("margin-top")), 'left': newOffset.left - old.data('dx') - parseInt($(this).css("margin-left"))}, 600, function() {
				neww.css("opacity", 1);
				temp.remove();
			});
		});
	});
	$(".overlay").click(function() {
		var album = $(".album.open");
		album.removeClass("open");
                $(this).children(".polaroid").each(function(index) {
                        var old = $(this);
                        var neww = album.children(".polaroid:eq(" + index + ")");
                        var newOffset = neww.offset();
                        var oldOffset = old.offset();
                        var temp = neww.clone().appendTo('body').css("opacity", 1);
			temp.css('position', 'absolute').css('left', oldOffset.left - neww.data('dx') - parseInt($(this).css("margin-left"))).css('top', oldOffset.top - neww.data('dy') - parseInt($(this).css("margin-top"))).css('z-index', index);
                        temp.animate({'top': newOffset.top - neww.data('dy') - parseInt($(this).css("margin-top")), 'left': newOffset.left + 8 - neww.data('dx') - parseInt($(this).css("margin-left"))}, 600, function() {
                                neww.css("opacity", 1);
                                old.remove();
				temp.remove();
                        });
                });
		$(".overlay").css({"display": "none"});
	});
});
</script>
